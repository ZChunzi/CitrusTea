(()=>{"use strict";var e=(new class{constructor(){this.xhr=new XMLHttpRequest,this.xhr.overrideMimeType("application/json;charset=utf-8"),this.xhr.withCredentials=!1,this.baseurl="",this.headers={}}create(e){return this.baseurl=e,this}setHeader(e,t){this.headers[e]=t}setHeaders(e){this.headers=Object.assign(this.headers,e)}get(e,t={}){let s=`${this.baseurl}${e}`;if(Object.keys(t).length>0){s+="?";for(const e in t)s+=`${e}=${t[e]}&`;s=s.slice(0,-1)}return this.xhr.open("GET",s),this.setHeaders(this.headers),this.sendRequest()}post(e,t={}){const s=`${this.baseurl}${e}`;this.xhr.open("POST",s),this.setHeaders(this.headers),this.xhr.setRequestHeader("Content-Type","application/json;charset=utf-8");const n=JSON.stringify(t);return this.sendRequest(n)}put(e,t={}){const s=`${this.baseurl}${e}`;this.xhr.open("PUT",s),this.setHeaders(this.headers),this.xhr.setRequestHeader("Content-Type","application/json;charset=utf-8");const n=JSON.stringify(t);return this.sendRequest(n)}delete(e){const t=`${this.baseurl}${e}`;return this.xhr.open("DELETE",t),this.setHeaders(this.headers),this.sendRequest()}sendRequest(e){return new Promise(((t,s)=>{this.xhr.onload=()=>{if(4===this.xhr.readyState)if(200===this.xhr.status){let e;try{e=JSON.parse(this.xhr.responseText)}catch{e=this.xhr.responseText}const s={code:this.xhr.status,data:e};t(s)}else s(new Error(this.xhr.statusText))},this.xhr.onerror=()=>{s(new Error("Network Error"))};for(const e in this.headers)this.xhr.setRequestHeader(e,this.headers[e]);e?this.xhr.send(e):this.xhr.send()}))}}).create("/api/");const t=async({requestFunction:e,value:t,duration:n,className:a})=>{let r=document.createElement("button"),i=document.getElementById("app");r.innerText=t,r.className=a;r.addEventListener("click",(async()=>{const t=await e(r);s(t,n)})),i.appendChild(r)},s=async(e,t)=>{let s=document.createElement("div");s.innerText=e,s.className="floating-div",Object.assign(s.style,{position:"fixed",top:"10%",left:"47%",zIndex:9999999,background:"#229954 ",borderRadius:"3px",color:"rgb(255, 255, 255)",fontSize:"0.8em",padding:"0.8em"}),app.appendChild(s),s.style.transition=`transform ${t/1e3}s linear`,s.style.transform="translateY(0)",setTimeout((()=>{s.remove()}),t)},n=async(e,t)=>{const s=e[t||i()];s?(a(),await s()):r()},a=()=>{let e=document.getElementById("app");for(;e.firstChild;)e.firstChild.remove()},r=()=>{document.getElementById("app").innerHTML="404: Page Not Found"},i=()=>window.location.pathname,h=async()=>{t({requestFunction:async()=>((async t=>{e.setHeader("Authorization",t)})("token"),(await(async(t,s)=>{let{data:n}=await e.post(t,s);return n})("do",{})).code),value:"Post测试",duration:2e3,className:"test"}),t({requestFunction:async()=>(await(async(t,s)=>{let{data:n}=await e.get(t,s);return n})("add",{})).cishu,value:"Get测试",duration:2e3,className:"test"})},o={"/":h,"/home":h,"/about":async()=>{t({requestFunction:async()=>{d("/home")},value:"跳转测试",className:"test"})},"/poem":async()=>{let e=document.getElementById("app"),t=document.createElement("pre");t.className="divtest",t.innerText="蒹葭苍苍，白露为霜。\n所谓伊人，在水一方。\n溯洄从之，道阻且长。\n溯游从之，宛在水中央。\n蒹葭萋萋，白露未晞。\n所谓伊人，在水之湄。\n溯洄从之，道阻且跻。\n溯游从之，宛在水中坻。\n蒹葭采采，白露未已。\n所谓伊人，在水之涘。\n溯洄从之，道阻且右。\n溯游从之，宛在水中沚。",e.appendChild(t)}};n(o),document.addEventListener("click",(e=>{if("A"===e.target.tagName){e.preventDefault();const t=e.target.getAttribute("href");window.history.pushState(null,null,t),n(o)}}));const d=e=>{window.history.pushState(null,null,e),n(o)}})();